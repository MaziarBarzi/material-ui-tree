"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var e=require("react"),t=_interopDefault(e),r=_interopDefault(require("prop-types")),n=_interopDefault(require("classnames")),a=_interopDefault(require("@material-ui/core/Paper")),o=_interopDefault(require("@material-ui/core/Typography")),i=_interopDefault(require("@material-ui/core/List")),l=_interopDefault(require("@material-ui/icons/KeyboardArrowUp")),c=_interopDefault(require("@material-ui/icons/KeyboardArrowDown")),u=_interopDefault(require("@material-ui/icons/MoreVert")),s=_interopDefault(require("@material-ui/core/Collapse")),p=_interopDefault(require("@material-ui/core/ListItem")),f=_interopDefault(require("@material-ui/core/ListItemIcon")),d=_interopDefault(require("@material-ui/core/ListItemText")),m=require("@material-ui/core/styles"),y=_interopDefault(require("@material-ui/core/Button")),b=_interopDefault(require("@material-ui/core/IconButton")),g=_interopDefault(require("@material-ui/core/Tooltip"));function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,a=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||function _unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=t.createContext({}),v=m.makeStyles((function(e){return{paper:{paddingTop:e.spacing(3),paddingBottom:e.spacing(3)},caption:{fontSize:16,textAlign:"center"},item:{width:"auto",height:32,paddingRight:e.spacing(2)},treeIconContainer:{minWidth:"initial"},treeIcon:{width:16,height:16,marginRight:8},treeIconButton:{color:e.palette.primary.light},treeTextButton:{color:e.palette.primary.light},treeText:{flex:"0 0 auto",paddingLeft:e.spacing(1),paddingRight:e.spacing(3)},treeTextFlex:{flex:1},button:{minWidth:"auto",minHeight:"auto",width:"auto",height:"auto",fontSize:12,lineHeight:1,padding:4},actionIcon:{width:12,height:12}}})),T=function TreeNode(r){var a=v(),o=m.useTheme(),i=e.useContext(h),l=i.foldIcon,c=i.unfoldIcon,u=i.labelKey,s=i.renderLabel,T=i.actionsAlignRight,_=i.getActionsData,O=r.data,j=r.unfoldStatus,E=r.depth,I=r.path,q=r.toggleFoldStatus,D=r.onClick,C=e.useCallback((function(e){return t.cloneElement(e,{className:a.treeIcon})}),[a]),k=e.useCallback((function(){return s&&"function"==typeof s?s(O,j):O[u]}),[s,u,O,j]),A=e.useCallback((function(e){return function(t){t.preventDefault(),t.stopPropagation(),e()}}),[]),x=e.useMemo((function(){if(_&&"function"==typeof _){var e=[].concat(_(O,I,j,q)||[]);if(e&&e.length)return e.map((function(e,r){var n=e.icon,i=e.label,l=e.hint,c=e.style,u=void 0===c?{}:c,s=e.onClick,p=void 0===s?function(){}:s,f=_objectWithoutProperties(e,["icon","label","hint","style","onClick"]),d=Object.assign({marginLeft:o.spacing(2)},u),m=null;return i?m=t.createElement(y,{size:"small"},n&&t.cloneElement(n,{className:a.actionIcon}),i):n&&(m=t.createElement(b,null,n)),m&&(m=t.cloneElement(m,function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({color:"primary",className:a.button,style:d,onClick:A(p)},f)),l&&(m=t.createElement(g,{title:l,placement:T?"left":"right"},m))),m&&t.cloneElement(m,{key:"tree-node-".concat(I.join("-"),"-action-").concat(e.id||e.name||e.key||r+1)})}))}return null}),[_,T,O,I,j,q,o,a,A]);return t.createElement(p,{dense:!0,button:!0,onClick:D,className:a.item,style:{marginLeft:E*o.spacing(3)}},t.createElement(f,{className:a.treeIconContainer},C(j?c:l)),t.createElement(d,{primary:k(),className:n(a.treeText,_defineProperty({},a.treeTextFlex,T))}),x)};T.propTypes={data:r.object.isRequired,unfoldStatus:r.bool.isRequired,depth:r.number.isRequired,path:r.arrayOf(r.number).isRequired,toggleFoldStatus:r.func.isRequired,onClick:r.func.isRequired};var _=function Tree(r){var a=v(),o=m.useTheme(),i=e.useContext(h),l=i.unfoldAll,c=i.unfoldFirst,u=i.valueKey,y=i.childrenKey,b=i.pageSize,g=i.loadMoreIcon,_=i.renderLoadMoreText,O=i.requestChildrenData,j=r.data,E=r.depth,I=r.path,q=_slicedToArray(e.useState(l||0===E&&c),2),D=q[0],C=q[1],k=j[y]||[],A=Math.ceil(k.length/b),x=_slicedToArray(e.useState(0),2),S=x[0],w=x[1],P=e.useCallback((function(){C(!D)}),[D,C]),L=e.useCallback((function(){var e=(S+1)*b;return k.slice(0,e).map((function(e,r){return t.createElement(Tree,{key:"tree-branch-".concat(e[u]),data:e,depth:E+1,path:I.concat(r)})}))}),[u,k,S,b,E,I]),N=e.useCallback((function(e){return t.cloneElement(e,{className:n(a.treeIcon,a.treeIconButton)})}),[a]),R=e.useCallback((function(){w(S+1)}),[S,w]),K=e.useCallback((function(){D||k.length>0?P():O&&"function"==typeof O?O(j,I,P):P()}),[D,P,k,O,j,I]);return t.createElement(t.Fragment,null,t.createElement(T,{data:j,unfoldStatus:D,depth:E,path:I,toggleFoldStatus:P,onClick:K}),t.createElement(s,{in:D,unmountOnExit:!0},L(),D&&S+1<A&&t.createElement(p,{dense:!0,button:!0,onClick:R,className:a.item,style:{marginLeft:(E+1)*o.spacing(3)}},t.createElement(f,{className:a.treeIconContainer},N(g)),t.createElement(d,{primary:_(S,b,k.length),className:n(a.treeText,a.treeTextButton)}))))};_.propTypes={data:r.object.isRequired,depth:r.number.isRequired,path:r.arrayOf(r.number).isRequired};var O=function MuiTree(e){var r=v(),l=e.className,c=e.title,u=e.data,s=_objectWithoutProperties(e,["className","title","data"]);return t.createElement(a,{className:n(r.paper,l)},c&&t.createElement(o,{variant:"h6",className:r.caption},c),u&&t.createElement(h.Provider,{value:s},t.createElement(i,{dense:!0,component:"div"},t.createElement(_,{data:u,depth:0,path:[]}))))};O.defaultProps={data:{},className:"",title:"",labelKey:"label",valueKey:"value",childrenKey:"children",unfoldFirst:!1,unfoldAll:!1,pageSize:20,foldIcon:t.createElement(l,null),unfoldIcon:t.createElement(c,null),loadMoreIcon:t.createElement(u,null),actionsAlignRight:!1,getActionsData:null,renderLabel:null,renderLoadMoreText:function renderLoadMoreText(e,t,r){return"Loaded pages: ".concat(e+1," / Page size: ").concat(t," / Total: ").concat(r,". Click here to load more...")},requestChildrenData:null},O.propTypes={data:r.object,className:r.string,title:r.oneOfType([r.string,r.node]),labelKey:r.string,valueKey:r.string,childrenKey:r.string,unfoldFirst:r.bool,unfoldAll:r.bool,pageSize:r.number,foldIcon:r.element,unfoldIcon:r.element,loadMoreIcon:r.element,actionsAlignRight:r.bool,getActionsData:r.func,renderLabel:r.func,renderLoadMoreText:r.func,requestChildrenData:r.func},module.exports=O;
